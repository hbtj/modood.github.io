『Go 语法基础』之切片
=====================

Table of contents
-----------------

*   [数组](#数组)
*   [切片](#切片)
*   [nil 切片和空切片](#nil-切片和空切片)
*   [内建函数](#内建函数)
*   [重新切片](#重新切片)
*   [遍历](#遍历)

## 数组

数组是单一类型元素的编号序列，长度是数组类型的一部分，其值必须为 int 类型的非负常量

数组声明时需要指定长度以及元素类型。

使用数组字面量可以快速创建并初始化数组：

```go
arr := [5]int{10, 20, 30, 40, 50}
```

使用 ... 代替数组的长度可以根据初始化时数组元素的数量来确定该数组的长度：

```go
arr := [...]{0, 1, 2, 3, 4}
```

## 切片

切片是数组连续段的引用，有三个组成部分：指向底层数组的指针，长度，容量。

切片一旦初始化，就总是伴随着一个包含其元素的基本数组。切片长度可以动态地改变。

分配内存并初始化（指定长度和容量都为 5）：

```go
scores := make([]int, 5)
```

分配内存并初始化（指定长度 5，容量 10），两种形式等价的，只是第二种是先创建数组再切片：

```go
make([]int, 5, 10)
new([10]int)[0:5]
```

使用字面量创建的同时初始化，需要知道初始值：

```go
scores := []int{1, 4, 293, 4, 9}
```

## nil 切片和空切片

nil 切片指向底层数组的指针为 nil，长度为 0，容量为 0。不分配任何存储空间。
用于表示一个不存在的切片，例如函数要求返回一个切片但是发生错误的时候。

```go
var s []int
```

空切片指向底层数组的指针不为 nil，长度为 0，容量为 0。也不分配任何存储空间。
用于表示空集合，例如数据库查询返回 0 个查询结构的时候。

```go
s := make([]int, 0)
```
```go
s := []int{}
```

不管是 nil 切片还是空切片，对其调用内置函数 append、len 和 cap 的效果都是一样的。

## 内建函数

```
len         切片长度
cap         切片容量
make        切片创建，可以接收两个到三个参数，用于初始化长度和容量
append      切片追加元素，返回新切片，不会改变源切片，新切片长度增加，容量和源切片一样
copy        切片复制
```

## 重新切片

```
a[:]              // 等价于 a[0:len(a)]
a[:X]             // 等价于 a[0:X]
a[X:]             // 等价于 a[X:len(a)]
a[X:Y]            // 等价于 a[X:Y]
```

重新切片后的新切片：

-   包括索引为 X 的元素，不包括索引为 Y 的元素
-   len(new) 等于 Y - X
-   cap(new) 等于 cap(source) - X

## 遍历

for 循环的 range 可以对 slice 进行遍历。

```go
pow := []int{1, 2, 4, 8, 16, 32, 64, 128}
for i, v := range pow {
  fmt.Println(i, v)
}
```

